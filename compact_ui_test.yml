# Convention Over Configuration Example
#
# This example shows the new compact syntax where code is auto-discovered:
# 1. If no 'code' or 'code_file' specified, looks for method in performance_scripts.py
# 2. If not found, looks for agent_scripts/{step_name}.py
# 3. Only provide explicit code when needed
#
# Prerequisites:
# 1. Deploy agents (see remote_agent_complete_guide.md)
# 2. Set environment variables:
#    export US_EAST_ENDPOINT="http://us-server.com:9090"
#    export US_EAST_TOKEN="your-token"
#    export EU_WEST_ENDPOINT="http://eu-server.com:9090"
#    export EU_WEST_TOKEN="your-token"

test_info:
  test_suite_name: "Compact UI Performance Test"
  description: "Demonstrates convention-over-configuration approach"
  version: "1.0"

agents:
  us-east:
    endpoint: "${US_EAST_ENDPOINT}"
    auth_token: "${US_EAST_TOKEN}"
    timeout: 120
  
  eu-west:
    endpoint: "${EU_WEST_ENDPOINT}"
    auth_token: "${EU_WEST_TOKEN}"
    timeout: 120

workflows:
  ui_performance:
    iterations: 10
    steps:
      # No code needed! Automatically finds ui_test_us_east() in performance_scripts.py
      - name: ui_test_us_east
        action: agent_execute
        agent: us-east
        context:
          url: "https://example.com"
          viewport_width: 1920
          viewport_height: 1080
          region: "us-east"
      
      # No code needed! Automatically finds ui_test_eu_west() in performance_scripts.py
      - name: ui_test_eu_west
        action: agent_execute
        agent: eu-west
        context:
          url: "https://example.com"
          viewport_width: 1920
          viewport_height: 1080
          region: "eu-west"
      
      # No code needed! Automatically finds agent_scripts/distributed_ui_test.py
      - name: distributed_ui_test
        action: agent_execute
        agent: us-east
        context:
          url: "https://example.com"
          region: "us-east-fallback"
      
      # Explicit code when you need custom logic
      - name: custom_check
        action: agent_execute
        agent: us-east
        code: |
          import requests
          import time
          
          start = time.time()
          r = requests.get("https://api.github.com")
          result = {
              "duration": time.time() - start,
              "status": r.status_code
          }

reporting:
  output_dir: "performance_results/compact_ui_test"
  formats: ["html", "json"]
